@page "/AddCompany"
@using ESOF.WebApp.DBLayer.Entities
@inject HttpClient Http

<h3>Adicionar Empresa</h3>

<form id="addCompanyForm" @onsubmit="HandleSubmit">
    <div class="form-group">
        <label for="name">Nome da Empresa:</label>
        <input id="name" class="form-control" @bind="newCompany.Name" />
    </div>

    <div class="form-group">
        <label for="location">Localização:</label>
        <input id="location" class="form-control" @bind="newCompany.Location" />
    </div>

    <div class="form-group">
        <label for="minFunc">Mínimo de funcionários:</label>
        <input id="minFunc" class="form-control" @bind="newCompany.MinFunc" />
    </div>

    <div class="form-group">
        <label for="maxFunc">Número máximo de funcionários:</label>
        <input id="maxFunc" class="form-control" @bind="newCompany.MaxFunc" />
    </div>

    <div class="form-group">
        <label for="site">Site:</label>
        <input id="site" class="form-control" @bind="newCompany.Site" />
    </div>

    <div class="form-group">
        <label for="urlImage">URL da Imagem:</label>
        <input id="urlImage" class="form-control" @bind="newCompany.UrlImage" />
    </div>

    <button type="submit" class="btn btn-primary">Adicionar Empresa</button>
</form>

@code {
    private Companies newCompany = new Companies();

    private async Task HandleSubmit()
    {
        try
        {
            var response = await Http.PostAsJsonAsync("/companies", newCompany);
            response.EnsureSuccessStatusCode();

            // Limpar o formulário após o sucesso
            newCompany = new Companies();

            // Exibir mensagem de sucesso
            Console.WriteLine("Empresa adicionada com sucesso!");
        }
        catch (Exception ex)
        {
            // Lidar com o erro
            Console.WriteLine($"Erro ao adicionar empresa: {ex.Message}");
        }
    }
}
